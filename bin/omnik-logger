#!/usr/bin/env python

import os
import argparse
import configparser

# from omnik import DataLoggerWifi, DataLoggerEth

from omnik import DataLogger

def main(c, debug):
  clazz = DataLogger(c, debug)
  clazz.process()

if __name__ == '__main__':
  base_dir = os.path.dirname(os.path.realpath(__file__))

  parser = argparse.ArgumentParser()
  parser.add_argument('--config', default='{}/../config.ini'.format(base_dir), help='Path to configuration file', metavar="FILE")
  parser.add_argument('-d', '--debug', action='store_true', help='Debug mode')

  args = parser.parse_args()

  if args.config:
    c = configparser.ConfigParser(converters={'list': lambda x: [i.strip() for i in x.split(',')]})
    c.read([args.config], encoding='utf-8')

  main(c, args.debug)